{"version":3,"file":"chunk-ids.js","sourceRoot":"","sources":["chunk-ids.ts"],"names":[],"mappings":";AAAA,kGAAkG;AAClG,iCAAiC;;AAajC,0DA2CC;AA/CD,IAAI,kBAAiE,CAAA;AACrE,IAAI,aAAiC,CAAA;AACrC,IAAI,sBAAkD,CAAA;AAEtD,SAAgB,uBAAuB,CAAC,WAAwB;IAC9D,IAAM,UAAU,GAAI,UAAkB,CAAC,gBAA8C,CAAA;IACrF,IAAI,CAAC,UAAU,EAAE,CAAC;QAChB,OAAO,SAAS,CAAA;IAClB,CAAC;IAED,IAAM,WAAW,GAAG,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;IAE3C,IAAI,sBAAsB,IAAI,WAAW,CAAC,MAAM,KAAK,aAAa,EAAE,CAAC;QACnE,OAAO,sBAAsB,CAAA;IAC/B,CAAC;IAED,aAAa,GAAG,WAAW,CAAC,MAAM,CAAA;IAElC,sBAAsB,GAAG,WAAW,CAAC,MAAM,CAAyB,UAAC,GAAG,EAAE,QAAQ;QAChF,IAAI,CAAC,kBAAkB,EAAE,CAAC;YACxB,kBAAkB,GAAG,EAAE,CAAA;QACzB,CAAC;QAED,IAAM,MAAM,GAAG,kBAAkB,CAAC,QAAQ,CAAC,CAAA;QAE3C,IAAI,MAAM,EAAE,CAAC;YACX,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAA;QAC5B,CAAC;aAAM,CAAC;YACN,IAAM,WAAW,GAAG,WAAW,CAAC,QAAQ,CAAC,CAAA;YAEzC,KAAK,IAAI,CAAC,GAAG,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;gBACjD,IAAM,UAAU,GAAG,WAAW,CAAC,CAAC,CAAC,CAAA;gBACjC,IAAM,QAAQ,GAAG,UAAU,aAAV,UAAU,uBAAV,UAAU,CAAE,QAAQ,CAAA;gBACrC,IAAM,OAAO,GAAG,UAAU,CAAC,QAAQ,CAAC,CAAA;gBAEpC,IAAI,QAAQ,IAAI,OAAO,EAAE,CAAC;oBACxB,GAAG,CAAC,QAAQ,CAAC,GAAG,OAAO,CAAA;oBACvB,kBAAkB,CAAC,QAAQ,CAAC,GAAG,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAA;oBAClD,MAAK;gBACP,CAAC;YACH,CAAC;QACH,CAAC;QAED,OAAO,GAAG,CAAA;IACZ,CAAC,EAAE,EAAE,CAAC,CAAA;IAEN,OAAO,sBAAsB,CAAA;AAC/B,CAAC","sourcesContent":["// Portions of this file are derived from getsentry/sentry-javascript by Software, Inc. dba Sentry\n// Licensed under the MIT License\n\nimport type { StackParser } from './types'\n\ntype StackString = string\ntype CachedResult = [string, string]\n\ntype ChunkIdMapType = Record<string, string>\n\nlet parsedStackResults: Record<StackString, CachedResult> | undefined\nlet lastKeysCount: number | undefined\nlet cachedFilenameChunkIds: ChunkIdMapType | undefined\n\nexport function getFilenameToChunkIdMap(stackParser: StackParser): ChunkIdMapType | undefined {\n  const chunkIdMap = (globalThis as any)._posthogChunkIds as ChunkIdMapType | undefined\n  if (!chunkIdMap) {\n    return undefined\n  }\n\n  const chunkIdKeys = Object.keys(chunkIdMap)\n\n  if (cachedFilenameChunkIds && chunkIdKeys.length === lastKeysCount) {\n    return cachedFilenameChunkIds\n  }\n\n  lastKeysCount = chunkIdKeys.length\n\n  cachedFilenameChunkIds = chunkIdKeys.reduce<Record<string, string>>((acc, stackKey) => {\n    if (!parsedStackResults) {\n      parsedStackResults = {}\n    }\n\n    const result = parsedStackResults[stackKey]\n\n    if (result) {\n      acc[result[0]] = result[1]\n    } else {\n      const parsedStack = stackParser(stackKey)\n\n      for (let i = parsedStack.length - 1; i >= 0; i--) {\n        const stackFrame = parsedStack[i]\n        const filename = stackFrame?.filename\n        const chunkId = chunkIdMap[stackKey]\n\n        if (filename && chunkId) {\n          acc[filename] = chunkId\n          parsedStackResults[stackKey] = [filename, chunkId]\n          break\n        }\n      }\n    }\n\n    return acc\n  }, {})\n\n  return cachedFilenameChunkIds\n}\n"]}