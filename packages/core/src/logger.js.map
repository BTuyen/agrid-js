{"version":3,"file":"logger.js","sourceRoot":"","sources":["logger.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuDA,oCAEC;AA/CD,SAAS,aAAa,CAAC,WAAkC;IAAlC,4BAAA,EAAA,qBAAkC;IACvD,IAAM,aAAa,GAAG;QACpB,GAAG,EAAE,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC;QACtC,IAAI,EAAE,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC;QACxC,KAAK,EAAE,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC;QAC1C,KAAK,EAAE,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC;KAC3C,CAAA;IACD,OAAO,aAAa,CAAA;AACtB,CAAC;AAEM,IAAM,aAAa,GAAG,UAC3B,MAAc,EACd,SAAmC,EACnC,WAAwB;IAExB,SAAS,IAAI,CAAC,KAA+B;QAAE,cAAc;aAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;YAAd,6BAAc;;QAC3D,SAAS,CAAC;YACR,IAAM,aAAa,GAAG,WAAW,CAAC,KAAK,CAAC,CAAA;YACxC,aAAa,8BAAC,MAAM,UAAK,IAAI,WAAC;QAChC,CAAC,CAAC,CAAA;IACJ,CAAC;IAED,IAAM,MAAM,GAAW;QACrB,IAAI,EAAE;YAAC,cAAc;iBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;gBAAd,yBAAc;;YACnB,IAAI,8BAAC,KAAK,UAAK,IAAI,WAAC;QACtB,CAAC;QAED,IAAI,EAAE;YAAC,cAAc;iBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;gBAAd,yBAAc;;YACnB,IAAI,8BAAC,MAAM,UAAK,IAAI,WAAC;QACvB,CAAC;QAED,KAAK,EAAE;YAAC,cAAc;iBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;gBAAd,yBAAc;;YACpB,IAAI,8BAAC,OAAO,UAAK,IAAI,WAAC;QACxB,CAAC;QAED,QAAQ,EAAE;YAAC,cAAc;iBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;gBAAd,yBAAc;;YACvB,mDAAmD;YACnD,WAAW,CAAC,OAAO,CAAC,OAApB,WAAW,iBAAU,MAAM,UAAK,IAAI,WAAC;QACvC,CAAC;QAED,YAAY,EAAE,UAAC,gBAAwB,IAAK,OAAA,IAAA,qBAAa,EAAC,UAAG,MAAM,cAAI,gBAAgB,CAAE,EAAE,SAAS,EAAE,WAAW,CAAC,EAAtE,CAAsE;KACnH,CAAA;IACD,OAAO,MAAM,CAAA;AACf,CAAC,CAAA;AAjCY,QAAA,aAAa,iBAiCzB;AAED,SAAgB,YAAY,CAAC,MAAc,EAAE,SAAmC;IAC9E,OAAO,IAAA,qBAAa,EAAC,MAAM,EAAE,SAAS,EAAE,aAAa,EAAE,CAAC,CAAA;AAC1D,CAAC","sourcesContent":["import { Logger } from './types'\n\n// We want to make sure to get the original console methods as soon as possible\ntype ConsoleLike = {\n  log: (...args: any[]) => void\n  warn: (...args: any[]) => void\n  error: (...args: any[]) => void\n  debug: (...args: any[]) => void\n}\n\nfunction createConsole(consoleLike: ConsoleLike = console): ConsoleLike {\n  const lockedMethods = {\n    log: consoleLike.log.bind(consoleLike),\n    warn: consoleLike.warn.bind(consoleLike),\n    error: consoleLike.error.bind(consoleLike),\n    debug: consoleLike.debug.bind(consoleLike),\n  }\n  return lockedMethods\n}\n\nexport const _createLogger = (\n  prefix: string,\n  maybeCall: (fn: () => void) => void,\n  consoleLike: ConsoleLike\n): Logger => {\n  function _log(level: 'log' | 'warn' | 'error', ...args: any[]) {\n    maybeCall(() => {\n      const consoleMethod = consoleLike[level]\n      consoleMethod(prefix, ...args)\n    })\n  }\n\n  const logger: Logger = {\n    info: (...args: any[]) => {\n      _log('log', ...args)\n    },\n\n    warn: (...args: any[]) => {\n      _log('warn', ...args)\n    },\n\n    error: (...args: any[]) => {\n      _log('error', ...args)\n    },\n\n    critical: (...args: any[]) => {\n      // Critical errors are always logged to the console\n      consoleLike['error'](prefix, ...args)\n    },\n\n    createLogger: (additionalPrefix: string) => _createLogger(`${prefix} ${additionalPrefix}`, maybeCall, consoleLike),\n  }\n  return logger\n}\n\nexport function createLogger(prefix: string, maybeCall: (fn: () => void) => void) {\n  return _createLogger(prefix, maybeCall, createConsole())\n}\n"]}